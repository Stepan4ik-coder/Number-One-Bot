"""
–•–µ–Ω–¥–ª–µ—Ä /join –∏ –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏.

–û–ü–ò–°–ê–ù–ò–ï:
–ú–æ–¥—É–ª—å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∫–æ–º–∞–Ω–¥—ã /join –¥–ª—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
–ë–æ—Ç —Å–æ–±–∏—Ä–∞–µ—Ç –∞–Ω–∫–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞—è–≤–∫—É –≤ WhatsApp.

–°–¢–†–£–ö–¢–£–†–ê –ë–ê–ó–´ –î–ê–ù–ù–´–•:
- User: –û—Å–Ω–æ–≤–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- Programme: –¢–∞–±–ª–∏—Ü–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º –æ–±—É—á–µ–Ω–∏—è

–ü–ï–†–ï–ú–ï–ù–ù–´–ï:
- user_id: –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
- username: –ù–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Telegram
- first_name: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/—Ä–µ–±–µ–Ω–∫–∞
- surname: –§–∞–º–∏–ª–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è/—Ä–µ–±–µ–Ω–∫–∞
- age: –í–æ–∑—Ä–∞—Å—Ç —Ä–µ–±–µ–Ω–∫–∞
- phone_number: –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ 8(***)*** ** **
- programme: –í—ã–±—Ä–∞–Ω–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±—É—á–µ–Ω–∏—è

–ò–ú–ü–û–†–¢–´:
- telebot.types.Message: –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è Telegram
- loader.bot: –≠–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
- database.models: –ú–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- .check_user_existance.check_exists: –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- keyboards.reply: –ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã –¥–ª—è –æ—Ç–≤–µ—Ç–æ–≤
- pywhatkit: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –≤ WhatsApp
"""

# –ò–º–ø–æ—Ä—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –º–æ–¥—É–ª–µ–π
from telebot.types import Message  # üì® –¢–∏–ø —Å–æ–æ–±—â–µ–Ω–∏—è Telegram
from loader import bot  # ü§ñ –û—Å–Ω–æ–≤–Ω–æ–π —ç–∫–∑–µ–º–ø–ª—è—Ä –±–æ—Ç–∞
from database import models  # üóÑÔ∏è –ú–æ–¥–µ–ª–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
from .check_user_existance import check_exists  # ‚úÖ –§—É–Ω–∫—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
import keyboards.reply  # ‚å®Ô∏è –ú–æ–¥—É–ª—å —Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞–º–∏
import pywhatkit  # üì≤ –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å WhatsApp


@bot.message_handler(commands=["join"])
def join_to_number_one(message: Message):
    """
    üéØ –û–°–ù–û–í–ù–û–ô –•–ï–ù–î–õ–ï–†: –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã /join

    –ü–ê–†–ê–ú–ï–¢–†–´:
    - message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram

    –õ–û–ì–ò–ö–ê:
    1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç user_id –∏ username –∏–∑ —Å–æ–æ–±—â–µ–Ω–∏—è
    2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —á–µ—Ä–µ–∑ check_exists()
    3. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–æ–≤—ã–π:
       - –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ –ë–î —Å phone_number='pending'
       - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
       - –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ü–µ–ø–æ—á–∫—É —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ get_first_name()
    4. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –∑–∞–≤–µ—Ä—à–∞–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ

    –ü–†–ò–ú–ï–† –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø:
    –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: /join
    –ë–æ—Ç: "üéâ –ú—ã —Ä–∞–¥—ã, —á—Ç–æ –≤—ã –≥–æ—Ç–æ–≤—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ Number One!"
         "üë§ –í–∞—à–µ –∏–º—è (–∏–º—è —Ä–µ–±—ë–Ω–∫–∞): "
    """
    user_id = message.from_user.id  # üîë –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    username = message.from_user.username  # üë§ –ù–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    if check_exists(user_id, message):
        return True  # ‚èπÔ∏è –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - –æ—Å—Ç–∞–Ω–æ–≤–∫–∞
    else:
        # –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
        models.User.create(
            user_id=user_id,  # üîë ID Telegram
            username=username,  # üë§ –ù–∏–∫–Ω–µ–π–º
            phone_number='pending'  # ‚è≥ –í—Ä–µ–º–µ–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Ç—Ä–µ–±—É–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è)
        )
        bot.send_message(message.chat.id, 'üéâ –ú—ã —Ä–∞–¥—ã, —á—Ç–æ –≤—ã –≥–æ—Ç–æ–≤—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ Number One!')

        # –ó–∞–ø—É—Å–∫ —Ü–µ–ø–æ—á–∫–∏ —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö
        first_name = bot.send_message(message.chat.id, 'üë§ –í–∞—à–µ –∏–º—è (–∏–º—è —Ä–µ–±—ë–Ω–∫–∞): ')
        bot.register_next_step_handler(first_name, get_first_name)  # ‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É


def get_first_name(message):
    """
    üë§ –®–ê–ì 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    –ü–ê–†–ê–ú–ï–¢–†–´:
    - message: –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–≤–µ–¥–µ–Ω–Ω—ã–º –∏–º–µ–Ω–µ–º

    –î–ï–ô–°–¢–í–ò–Ø:
    1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–∏–º—è)
    2. –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î –ø–æ user_id
    3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏–º—è –≤ –ø–æ–ª–µ first_name
    4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –∑–∞–ø—Ä–æ—Å —Ñ–∞–º–∏–ª–∏–∏

    –í–û–ó–í–†–ê–©–ê–ï–¢:
    - first_name: –°—Ç—Ä–æ–∫–∞ —Å –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    first_name = message.text  # üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–∏–º—è)
    user_id = message.from_user.id  # üîë ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    found_user = models.User.get_or_none(models.User.user_id == user_id)

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    found_user.first_name = first_name
    found_user.save()  # üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

    # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
    surname = bot.send_message(message.chat.id, 'üìã –í–∞—à–∞ —Ñ–∞–º–∏–ª–∏—è (—Ñ–∞–º–∏–ª–∏—è —Ä–µ–±—ë–Ω–∫–∞): ')
    bot.register_next_step_handler(surname, get_surname)  # ‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –∫ get_surname

    return first_name  # ‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç –∏–º–µ–Ω–∏


def get_surname(message):
    """
    üìã –®–ê–ì 2: –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–º–∏–ª–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    –ü–ê–†–ê–ú–ï–¢–†–´:
    - message: –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–≤–µ–¥–µ–Ω–Ω–æ–π —Ñ–∞–º–∏–ª–∏–µ–π

    –î–ï–ô–°–¢–í–ò–Ø:
    1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (—Ñ–∞–º–∏–ª–∏—é)
    2. –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ñ–∞–º–∏–ª–∏—é –≤ –ø–æ–ª–µ surname
    4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –∑–∞–ø—Ä–æ—Å –≤–æ–∑—Ä–∞—Å—Ç–∞

    –í–û–ó–í–†–ê–©–ê–ï–¢:
    - surname: –°—Ç—Ä–æ–∫–∞ —Å —Ñ–∞–º–∏–ª–∏–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    """
    surname = message.text  # üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (—Ñ–∞–º–∏–ª–∏—è)
    user_id = message.from_user.id  # üîë ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    found_user = models.User.get_or_none(models.User.user_id == user_id)

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    found_user.surname = surname
    found_user.save()  # üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

    # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
    phone_number = bot.send_message(message.chat.id, 'üéÇ –í–æ–∑—Ä–∞—Å—Ç —Ä–µ–±—ë–Ω–∫–∞: ')
    bot.register_next_step_handler(phone_number, get_age)  # ‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –∫ get_age

    return surname  # ‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç —Ñ–∞–º–∏–ª–∏–∏


def get_age(message):
    """
    üéÇ –®–ê–ì 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ —Ä–µ–±–µ–Ω–∫–∞

    –ü–ê–†–ê–ú–ï–¢–†–´:
    - message: –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–≤–µ–¥–µ–Ω–Ω—ã–º –≤–æ–∑—Ä–∞—Å—Ç–æ–º

    –î–ï–ô–°–¢–í–ò–Ø:
    1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–≤–æ–∑—Ä–∞—Å—Ç)
    2. –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–æ–∑—Ä–∞—Å—Ç –≤ –ø–æ–ª–µ age
    4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –∑–∞–ø—Ä–æ—Å –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞

    –í–û–ó–í–†–ê–©–ê–ï–¢:
    - age: –°—Ç—Ä–æ–∫–∞ —Å –≤–æ–∑—Ä–∞—Å—Ç–æ–º —Ä–µ–±–µ–Ω–∫–∞
    """
    age = message.text  # üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–≤–æ–∑—Ä–∞—Å—Ç)
    user_id = message.from_user.id  # üîë ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    found_user = models.User.get_or_none(models.User.user_id == user_id)

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    found_user.age = age
    found_user.save()  # üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

    # –ü–µ—Ä–µ—Ö–æ–¥ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —à–∞–≥—É
    phone_number = bot.send_message(message.chat.id, 'üì± –í–∞—à –Ω–æ–º–µ—Ä –º–æ–±–∏–ª—å–Ω–æ–≥–æ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (–≤ —Ñ–æ—Ä–º–∞—Ç–µ: 8(***)*** ** **): ')
    bot.register_next_step_handler(phone_number, get_phone_number)  # ‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –∫ get_phone_number


def get_phone_number(message):
    """
    üì± –®–ê–ì 4: –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞

    –ü–ê–†–ê–ú–ï–¢–†–´:
    - message: –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤–≤–µ–¥–µ–Ω–Ω—ã–º –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞

    –§–û–†–ú–ê–¢:
    - 8(***)*** ** ** (–Ω–∞–ø—Ä–∏–º–µ—Ä: 8(912)345 67 89)

    –î–ï–ô–°–¢–í–ò–Ø:
    1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞)
    2. –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–º–µ—Ä –≤ –ø–æ–ª–µ phone_number
    4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–π —à–∞–≥ - –≤—ã–±–æ—Ä –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–±—É—á–µ–Ω–∏—è

    –í–û–ó–í–†–ê–©–ê–ï–¢:
    - phone_number: –°—Ç—Ä–æ–∫–∞ —Å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    """
    phone_number = message.text  # üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞)
    user_id = message.from_user.id  # üîë ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    found_user = models.User.get_or_none(models.User.user_id == user_id)

    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
    found_user.phone_number = phone_number
    found_user.save()  # üíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

    # –ü–µ—Ä–µ—Ö–æ–¥ –∫ –≤—ã–±–æ—Ä—É –ø—Ä–æ–≥—Ä–∞–º–º—ã (—Å –∫–ª–∞–≤–∏–∞—Ç—É—Ä–æ–π)
    programme = bot.send_message(
        message.chat.id,
        'üéì –ñ–µ–ª–∞–µ–º–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞ –æ–±—É—á–µ–Ω–∏—è:',
        reply_markup=keyboards.reply.buttons()  # ‚å®Ô∏è –ü–æ–∫–∞–∑ –∫–Ω–æ–ø–æ–∫ —Å –ø—Ä–æ–≥—Ä–∞–º–º–∞–º–∏
    )
    bot.register_next_step_handler(programme, get_programme)  # ‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –∫ get_programme

    return phone_number  # ‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç –Ω–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞


def get_programme(message):
    """
    üéì –®–ê–ì 5: –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ–±—É—á–µ–Ω–∏—è

    –ü–ê–†–ê–ú–ï–¢–†–´:
    - message: –°–æ–æ–±—â–µ–Ω–∏–µ —Å –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–æ–π

    –î–ï–ô–°–¢–í–ò–Ø:
    1. –ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã)
    2. –ù–∞—Ö–æ–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    3. –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ Programme
    4. –ó–∞–ø—É—Å–∫–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é all_information()

    –í–û–ó–í–†–ê–©–ê–ï–¢:
    - programme: –°—Ç—Ä–æ–∫–∞ —Å –Ω–∞–∑–≤–∞–Ω–∏–µ–º –ø—Ä–æ–≥—Ä–∞–º–º—ã
    """
    programme = message.text  # üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è (–Ω–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã)
    user_id = message.from_user.id  # üîë ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    found_user = models.User.get_or_none(models.User.user_id == user_id)

    # –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –æ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º–µ
    models.Programme.create(
        programme_name=programme,  # üéì –ù–∞–∑–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
        user=found_user  # üë§ –°–≤—è–∑—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
    )

    # –ó–∞–ø—É—Å–∫ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
    all_information(message)  # ‚û°Ô∏è –ü–µ—Ä–µ—Ö–æ–¥ –∫ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö

    return programme  # ‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç –Ω–∞–∑–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã


def all_information(message):
    """
    üì® –§–ò–ù–ê–õ–¨–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø: –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ WhatsApp

    –ü–ê–†–ê–ú–ï–¢–†–´:
    - message: –û–±—ä–µ–∫—Ç —Å–æ–æ–±—â–µ–Ω–∏—è Telegram

    –õ–û–ì–ò–ö–ê:
    1. –ü–æ–ª—É—á–∞–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î
    2. –§–æ—Ä–º–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è WhatsApp
    3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –Ω–æ–º–µ—Ä —á–µ—Ä–µ–∑ pywhatkit
    4. –£–≤–µ–¥–æ–º–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ

    –û–ë–†–ê–ë–û–¢–ö–ê –û–®–ò–ë–û–ö:
    - try/except –±–ª–æ–∫ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –æ—Ç–ø—Ä–∞–≤–∫–∏
    - –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ —Å—Ç–∞—Ç—É—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
    """
    user_id = message.from_user.id  # üîë ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

    # –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –ë–î
    found_user = models.User.get_or_none(models.User.user_id == user_id)

    # –ü–æ–∏—Å–∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –ø—Ä–æ–≥—Ä–∞–º–º—ã
    name_of_programme = models.Programme.select().where(
        models.Programme.user == found_user
    ).first()  # üîç –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–π –∑–∞–ø–∏—Å–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã

    # –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–ª—è WhatsApp
    if name_of_programme is not None:
        whatsapp_message = (
            f'üëã –î–æ–±—Ä–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫!\n'
            f'üéØ –ñ–µ–ª–∞–µ–º –∑–∞–ø–∏—Å–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ!\n\n'
            f'üë§ –ò–º—è: {found_user.first_name}\n'
            f'üìã –§–∞–º–∏–ª–∏—è: {found_user.surname}\n'
            f'üéÇ –í–æ–∑—Ä–∞—Å—Ç: {found_user.age}\n'
            f'üìû –¢–µ–ª–µ—Ñ–æ–Ω: {found_user.phone_number}\n'
            f'üìö –ü—Ä–æ–≥—Ä–∞–º–º–∞: {name_of_programme.programme_name}\n\n'
            f'ü§ñ –ó–∞—è–≤–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ Telegram-–±–æ—Ç–∞!'
        )
    else:
        whatsapp_message = (
            f'üëã –î–æ–±—Ä–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—Ç–æ–∫!\n'
            f'üéØ –ñ–µ–ª–∞–µ–º –∑–∞–ø–∏—Å–∞—Ç—å –Ω–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ!\n\n'
            f'üë§ –ò–º—è: {found_user.first_name}\n'
            f'üìã –§–∞–º–∏–ª–∏—è: {found_user.surname}\n'
            f'üéÇ –í–æ–∑—Ä–∞—Å—Ç: {found_user.age}\n'
            f'üìû –¢–µ–ª–µ—Ñ–æ–Ω: {found_user.phone_number}\n'
            'üìö –ü—Ä–æ–≥—Ä–∞–º–º–∞: –ù–µ –≤—ã–±—Ä–∞–Ω–æ\n\n'
            f'ü§ñ –ó–∞—è–≤–∫–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∞ —á–µ—Ä–µ–∑ Telegram-–±–æ—Ç–∞!'
        )

    try:
        # üì§ –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ WhatsApp
        pywhatkit.sendwhatmsg_instantly(
            phone_no='89143724003',  # üìû –ù–æ–º–µ—Ä –ø–æ–ª—É—á–∞—Ç–µ–ª—è
            message=whatsapp_message,  # üìù –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
            wait_time=30,  # ‚è±Ô∏è –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è
            tab_close=True  # üö™ –ó–∞–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–∫–∏ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
        )

        # ‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—à–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–µ
        bot.send_message(
            message.chat.id,
            '‚úÖ –í–∞—à–∞ –∑–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞!\n'
            '‚è≥ –ñ–¥–∏—Ç–µ –æ—Ç–≤–µ—Ç–∞ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –≤ –ª–∏—á–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏!\n\n'
            'üìû –° –≤–∞–º–∏ —Å–≤—è–∂—É—Ç—Å—è –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è! üí´'
        )

    except Exception as error:
        # ‚ùå –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
        bot.send_message(
            message.chat.id,
            f'‚ùå –í–æ–∑–Ω–∏–∫–ª–∞ –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω–∞—è –æ—à–∏–±–∫–∞: {error}'
        )


